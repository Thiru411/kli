function adComma(){$(".addCommaDefault").each(function(){var e=$(this).text(),t=(e=e.toString()).substring(e.length-3),e=e.substring(0,e.length-3),e=(""!=e&&(t=","+t),e.replace(/\B(?=(\d{2})+(?!\d))/g,",")+t);$(this).text(e)})}$(document).ready(function(){compountInterest()}),$(".form-control").keypress(function(e){if(String.fromCharCode(e=e.which||event.keyCode).match(/[^((1\d)|(\d))(\.(\d\d)|\d){01}$]/g))return!1});var compoundFrequency,amtInvest,yearsInvest,stayInvested,rateOfInterest,totalAmtIntvested,noInvestSlot,returnAmount,yearlyReturn,amtInvestNew,myChart,finalAmtMonthly,investedAmtMonthly,currentYear,years,investedAmt=[];function stayInvestedError(){yearsInvest=parseInt($("#yearsInvestInput").val()),stayInvested=parseInt($("#stayInvestedInput").val());var e=parseFloat($("#stayInvestedRange").parents(".range-wrap").find(".range-control").attr("max")),t=$("#stayInvestedInput").val();stayInvested<yearsInvest?($("#stayInvestedInput").parents(".input-wrap").addClass("error"),$(".error-text").css("display","block")):(yearsInvest<stayInvested||""!==t)&&($("#stayInvestedInput").parents(".input-wrap").removeClass("error"),$(".error-text").css("display","none")),yearsInvest<stayInvested&&e<t&&($("#stayInvestedInput").parents(".input-wrap").addClass("error"),$(".error-text").css("display","none"))}function compountInterest(){compoundFrequency=$("#compoundFrequency").val(),amtInvest=parseInt($("#amtInvestInput").val().replace(/,/g,"")),yearsInvest=parseInt($("#yearsInvestInput").val()),stayInvested=parseInt($("#stayInvestedInput").val()),rateOfInterest=$("#rateOfInterestInput").val()/100,years=[currentYear=(currentYear=new Date).getFullYear()],investedAmt=[];var e=[],t=amtInvest;if("yearly"==compoundFrequency){document.getElementById("totalInvested").innerHTML=amtInvest,$(".perMonth").css("display","none"),$(".perAnnum").css("display","inline-block");for(var n=1;n<=yearsInvest;n++)t=t*rateOfInterest+t,e.push(t),finalAmt=t+amtInvest,finalAmt=e.map((t,n)=>e.slice(0,n+1).reduce((e,t)=>e+t)),investedAmt.push(amtInvest*n);for(n=1;n<stayInvested;n++)currentYear++,years.push(currentYear);noInvestSlot=stayInvested-yearsInvest;for(var a=finalAmt.slice(-1)[0],n=1;n<=noInvestSlot;n++)a=a*rateOfInterest+a,finalAmt.push(a);$("#stayInvestedInput").parents(".input-wrap").removeClass("error")}else if("monthly"==compoundFrequency){for(document.getElementById("totalInvested").innerHTML=amtInvest,$(".perMonth").css("display","inline-block"),$(".perAnnum").css("display","none"),yearsInvest*=12,investedAmt=[],investedAmtMonthly=[],n=1;n<=yearsInvest;n++)t=t*rateOfInterest/12+t,e.push(t),finalAmt=t+amtInvest,finalAmt=e.map((t,n)=>e.slice(0,n+1).reduce((e,t)=>e+t));if(yearsInvest<=(stayInvested*=12)){for(noInvestSlot=stayInvested-yearsInvest,a=finalAmt.slice(-1)[0],n=1;n<=noInvestSlot;n++)a=a*rateOfInterest/12+a,finalAmt.push(a);for(n=1;n<=yearsInvest;n++)investedAmt.push(amtInvest*n);for(n=11;n<investedAmt.length;n+=12)investedAmtMonthly.push(investedAmt[n]);for(n=2;n<=stayInvested/12;n++)currentYear++,years.push(currentYear)}for(n=11,finalAmtMonthly=[];n<finalAmt.length;n+=12)finalAmtMonthly.push(finalAmt[n]);console.log(finalAmtMonthly)}document.getElementById("compoundReturn").innerHTML=Math.round(finalAmt.slice(-1)),document.querySelector(".years_val").innerHTML=parseInt($("#yearsInvestInput").val()),document.querySelector(".percent_val").innerHTML=$("#rateOfInterestInput").val(),adComma()}function chartLine(){var e=document.getElementById("compound_interest_chart");myChart=new Chart(e,{type:"line",data:{label:"Years of Growth",labels:years,datasets:[{label:"Your Returns",data:finalAmt,pointBorderColor:"#004A8F",backgroundColor:"#004A8F",borderColor:"#CCDBE9",borderWidth:5}]},options:{scales:{y:{beginAtZero:!1,display:!0,title:{display:!0,color:"#ED1C24",text:"Amount Invested"},ticks:{color:"#004A8F",callback:function(e,t,n){return 1e7<=e?e=(e/1e7).toFixed(2)+" Cr":1e5<=e?e=(e/1e5).toFixed(2)+" Lac":1e3<=e&&(e=(e/1e3).toFixed(2)+" K"),e}}},x:{display:!0,title:{display:!0,text:"Years of Growth",color:"#004A8F"},ticks:{color:"#004A8F"}}},plugins:{legend:{display:!1},htmlLegend:{containerID:"legend"},tooltip:{displayColors:!1,backgroundColor:function(e){return e=e.tooltip.labelColors[0].borderColor},callbacks:{label:function(e,t){return["Your returns: "+parseFloat(e.parsed.y).toFixed(0)]}}}}},layout:{padding:{left:50}},plugins:[{id:"htmlLegend",afterUpdate(e,t,n){let a=(e=>{let t=document.getElementById(e);return(e=t.querySelector("ul"))||((e=document.createElement("ul")).style.display="flex",e.style.flexDirection="row",e.style.margin=0,e.style.padding=0,t.appendChild(e)),e})(n.containerID);for(;a.firstChild;)a.firstChild.remove();let r=e.options.plugins.legend.labels.generateLabels(e);r.forEach(t=>{let n=document.createElement("li"),r=(n.classList="legends_li",n.onclick=()=>{var n=e.config.type;"pie"===n||"doughnut"===n?e.toggleDataVisibility(t.index):e.setDatasetVisibility(t.datasetIndex,!e.isDatasetVisible(t.datasetIndex)),e.update()},document.createElement("span")),s=(r.style.background=t.fillStyle,r.classList="legend_box",document.createElement("p"));s.style.color=t.fontColor,s.classList="legend_text",s.style.textDecoration=t.hidden?"line-through":"";var o=document.createTextNode(t.text);s.appendChild(o),n.appendChild(r),n.appendChild(s),a.appendChild(n)})}}]})}returnAmount=[],$(document).on("change","#stayInvestedInput",function(){stayInvestedError()}),$(document).on("change","#yearsInvestInput, #yearsInvestRange",function(){stayInvestedError()}),$(document).on("change","#stayInvestedRange",function(){$("#stayInvestedInput").trigger("change")}),$(document).on("click","#calculate",function(){stayInvestedError(),0==$(".error").length?(compountInterest(),$("html, body").animate({scrollTop:$(".col-lg-5").offset().top-50},500)):$("html, body").animate({scrollTop:$(".error").offset().top-50},500),myChart.data.datasets[0].data=finalAmt,"monthly"==compoundFrequency&&(myChart.data.datasets[0].data=finalAmtMonthly),myChart.data.labels=years,myChart.update()}),$(document).ready(function(){compountInterest(),chartLine(),"monthly"==compoundFrequency&&(myChart.data.labels=years,myChart.data.datasets[0].data=finalAmtMonthly),myChart.update()});